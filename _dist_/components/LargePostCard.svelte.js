import"./LargePostCard.svelte.css.proxy.js";import{SvelteComponent as Fe,action_destroyer as K,append as a,attr as c,check_outros as Ge,compute_slots as Je,create_slot as Ke,destroy_each as Oe,detach as T,element as p,empty as Qe,group_outros as Ve,init as We,insert as N,is_function as O,run_all as Xe,safe_not_equal as Ye,set_data as S,space as L,text as v,toggle_class as B,transition_in as se,transition_out as ve,update_slot as Ze}from"../../_snowpack/pkg/svelte/internal.js";import{format as ae}from"../../_snowpack/pkg/date-fns.js";import{push as Ne}from"../../_snowpack/pkg/svelte-spa-router.js";import{assert as D,formatUserContent as Ee}from"../util.js";function Ue(l,e,n){const t=l.slice();return t[11]=e[n],t[13]=n,t}function qe(l){let e;return{c(){e=p("div"),c(e,"class","link link-top svelte-1lwrxr")},m(n,t){N(n,e,t)},d(n){n&&T(e)}}}function Re(l){var g;let e,n,t,i,o=((g=l[0].parent.author)==null?void 0:g.username)+"",s,r,u,_;return{c(){e=p("span"),n=v(`Replying to
        `),t=p("strong"),i=v("@"),s=v(o),c(t,"class","svelte-1lwrxr"),c(e,"class","parent svelte-1lwrxr")},m(M,C){N(M,e,C),a(e,n),a(e,t),a(t,i),a(t,s),u||(_=K(r=l[5].call(null,e,D(l[0].parent))),u=!0)},p(M,C){var E;C&1&&o!==(o=((E=M[0].parent.author)==null?void 0:E.username)+"")&&S(s,o),r&&O(r.update)&&C&1&&r.update.call(null,D(M[0].parent))},d(M){M&&T(e),u=!1,_()}}}function ze(l){let e,n=l[0].media,t=[];for(let i=0;i<n.length;i+=1)t[i]=Be(Ue(l,n,i));return{c(){e=p("div");for(let i=0;i<t.length;i+=1)t[i].c();c(e,"class","media svelte-1lwrxr")},m(i,o){N(i,e,o);for(let s=0;s<t.length;s+=1)t[s].m(e,null)},p(i,o){if(o&1){n=i[0].media;let s;for(s=0;s<n.length;s+=1){const r=Ue(i,n,s);t[s]?t[s].p(r,o):(t[s]=Be(r),t[s].c(),t[s].m(e,null))}for(;s<t.length;s+=1)t[s].d(1);t.length=n.length}},d(i){i&&T(e),Oe(t,i)}}}function $e(l){let e,n,t=l[11].type+"",i,o,s=l[11].src+"",r,u;return{c(){e=p("span"),n=v("Unknown media type: "),i=v(t),o=v(" (src: "),r=v(s),u=v(")"),c(e,"class","svelte-1lwrxr")},m(_,g){N(_,e,g),a(e,n),a(e,i),a(e,o),a(e,r),a(e,u)},p(_,g){g&1&&t!==(t=_[11].type+"")&&S(i,t),g&1&&s!==(s=_[11].src+"")&&S(r,s)},d(_){_&&T(e)}}}function xe(l){let e,n,t,i,o,s,r=l[11].caption&&Ae(l);return{c(){e=p("div"),n=p("img"),o=L(),r&&r.c(),s=L(),n.src!==(t=l[11].src)&&c(n,"src",t),c(n,"alt",i="attachment "+l[13]),c(n,"class","svelte-1lwrxr"),c(e,"class","attachment svelte-1lwrxr")},m(u,_){N(u,e,_),a(e,n),a(e,o),r&&r.m(e,null),a(e,s)},p(u,_){_&1&&n.src!==(t=u[11].src)&&c(n,"src",t),u[11].caption?r?r.p(u,_):(r=Ae(u),r.c(),r.m(e,s)):r&&(r.d(1),r=null)},d(u){u&&T(e),r&&r.d()}}}function Ae(l){let e,n=l[11].caption+"";return{c(){e=p("span"),c(e,"class","caption svelte-1lwrxr")},m(t,i){N(t,e,i),e.innerHTML=n},p(t,i){i&1&&n!==(n=t[11].caption+"")&&(e.innerHTML=n)},d(t){t&&T(e)}}}function Be(l){let e;function n(o,s){return o[11].type==="image"?xe:$e}let t=n(l,-1),i=t(l);return{c(){i.c(),e=Qe()},m(o,s){i.m(o,s),N(o,e,s)},p(o,s){t===(t=n(o,s))&&i?i.p(o,s):(i.d(1),i=t(o),i&&(i.c(),i.m(e.parentNode,e)))},d(o){i.d(o),o&&T(e)}}}function De(l){let e,n,t,i;const o=l[9].default,s=Ke(o,l,l[8],null);return{c(){e=p("div"),n=p("hr"),t=L(),s&&s.c(),c(n,"class","svelte-1lwrxr")},m(r,u){N(r,e,u),a(e,n),a(e,t),s&&s.m(e,null),i=!0},p(r,u){s&&s.p&&u&256&&Ze(s,o,r,r[8],u,null,null)},i(r){i||(se(s,r),i=!0)},o(r){ve(s,r),i=!1},d(r){r&&T(e),s&&s.d(r)}}}function el(l){var Ce,Pe;let e,n,t,i,o,s,r,u,_,g,M=((Ce=l[0].author)==null?void 0:Ce.displayName)+"",C,E,m,P,j=((Pe=l[0].author)==null?void 0:Pe.username)+"",q,R,z,ke,h,ie,F,Q=Ee(l[0].content)+"",he,re,oe,fe,ge,H,G,V,W=l[0].likes.toLocaleString()+"",ue,we,be,U,X,Y=l[3].toLocaleString()+"",ce,Le,Z=(l[3]===1?"":"s")+"",pe,$,Me,A,x,ee=ae(l[0].timestamp,"MMM d, yyy")+"",me,Ie,le,te=ae(l[0].timestamp,"h:mm a")+"",de,ne,I,_e,ye,y=(l[1]==="linked-top"||l[1]==="linked-full")&&qe(l),w=l[2]&&l[0].parent&&Re(l),b=l[0].media.length&&ze(l),k=l[6].default&&De(l);return{c(){var f,d,J;e=p("div"),n=p("header"),t=p("aside"),y&&y.c(),i=L(),o=p("img"),r=L(),u=p("aside"),_=p("span"),g=p("b"),C=v(M),E=L(),m=p("span"),P=v("@"),q=v(j),ke=L(),h=p("div"),w&&w.c(),ie=L(),F=p("span"),he=L(),b&&b.c(),re=L(),k&&k.c(),oe=L(),fe=p("hr"),ge=L(),H=p("div"),G=p("span"),V=p("strong"),ue=v(W),we=v(`
        points`),be=L(),U=p("span"),X=p("strong"),ce=v(Y),Le=v(`
        comment`),pe=v(Z),Me=L(),A=p("span"),x=p("span"),me=v(ee),Ie=v(`
        \xA0\xB7\xA0
        `),le=p("span"),de=v(te),o.src!==(s=(J=(d=(f=l[0].author)==null?void 0:f.profileImage)==null?void 0:d.src)!=null?J:"default.png")&&c(o,"src",s),c(o,"alt","profile"),c(o,"class","svelte-1lwrxr"),c(t,"class","svelte-1lwrxr"),c(_,"class","header svelte-1lwrxr"),c(m,"class","gray svelte-1lwrxr"),c(u,"class","svelte-1lwrxr"),c(n,"class","svelte-1lwrxr"),c(F,"class","content svelte-1lwrxr"),c(fe,"class","svelte-1lwrxr"),c(V,"class","svelte-1lwrxr"),c(G,"class","likes svelte-1lwrxr"),c(X,"class","svelte-1lwrxr"),c(U,"class","comments svelte-1lwrxr"),c(x,"class","gray svelte-1lwrxr"),c(le,"class","gray svelte-1lwrxr"),c(A,"class","timestamp svelte-1lwrxr"),c(H,"class","interactions svelte-1lwrxr"),c(h,"class","body svelte-1lwrxr"),c(e,"class","large-post-card svelte-1lwrxr"),B(e,"is-reply",l[2]&&!!l[0].parent),B(e,"linked-top",l[1]==="linked-top"||l[1]==="linked-full"),B(e,"linked-bottom",l[1]==="linked-bottom"||l[1]==="linked-full")},m(f,d){N(f,e,d),a(e,n),a(n,t),y&&y.m(t,null),a(t,i),a(t,o),a(n,r),a(n,u),a(u,_),a(_,g),a(g,C),a(u,E),a(u,m),a(m,P),a(m,q),a(e,ke),a(e,h),w&&w.m(h,null),a(h,ie),a(h,F),F.innerHTML=Q,a(h,he),b&&b.m(h,null),a(h,re),k&&k.m(h,null),a(h,oe),a(h,fe),a(h,ge),a(h,H),a(H,G),a(G,V),a(V,ue),a(G,we),a(H,be),a(H,U),a(U,X),a(X,ce),a(U,Le),a(U,pe),a(H,Me),a(H,A),a(A,x),a(x,me),a(A,Ie),a(A,le),a(le,de),I=!0,_e||(ye=[K(R=l[4].call(null,u,D(l[0].author))),K(z=l[4].call(null,n,D(l[0].author))),K($=l[5].call(null,U,l[0])),K(ne=l[5].call(null,H,l[0]))],_e=!0)},p(f,[d]){var J,je,Se,He,Te;f[1]==="linked-top"||f[1]==="linked-full"?y||(y=qe(f),y.c(),y.m(t,i)):y&&(y.d(1),y=null),(!I||d&1&&o.src!==(s=(Se=(je=(J=f[0].author)==null?void 0:J.profileImage)==null?void 0:je.src)!=null?Se:"default.png"))&&c(o,"src",s),(!I||d&1)&&M!==(M=((He=f[0].author)==null?void 0:He.displayName)+"")&&S(C,M),(!I||d&1)&&j!==(j=((Te=f[0].author)==null?void 0:Te.username)+"")&&S(q,j),R&&O(R.update)&&d&1&&R.update.call(null,D(f[0].author)),z&&O(z.update)&&d&1&&z.update.call(null,D(f[0].author)),f[2]&&f[0].parent?w?w.p(f,d):(w=Re(f),w.c(),w.m(h,ie)):w&&(w.d(1),w=null),(!I||d&1)&&Q!==(Q=Ee(f[0].content)+"")&&(F.innerHTML=Q),f[0].media.length?b?b.p(f,d):(b=ze(f),b.c(),b.m(h,re)):b&&(b.d(1),b=null),f[6].default?k?(k.p(f,d),d&64&&se(k,1)):(k=De(f),k.c(),se(k,1),k.m(h,oe)):k&&(Ve(),ve(k,1,1,()=>{k=null}),Ge()),(!I||d&1)&&W!==(W=f[0].likes.toLocaleString()+"")&&S(ue,W),(!I||d&8)&&Y!==(Y=f[3].toLocaleString()+"")&&S(ce,Y),(!I||d&8)&&Z!==(Z=(f[3]===1?"":"s")+"")&&S(pe,Z),$&&O($.update)&&d&1&&$.update.call(null,f[0]),(!I||d&1)&&ee!==(ee=ae(f[0].timestamp,"MMM d, yyy")+"")&&S(me,ee),(!I||d&1)&&te!==(te=ae(f[0].timestamp,"h:mm a")+"")&&S(de,te),ne&&O(ne.update)&&d&1&&ne.update.call(null,f[0]),d&5&&B(e,"is-reply",f[2]&&!!f[0].parent),d&2&&B(e,"linked-top",f[1]==="linked-top"||f[1]==="linked-full"),d&2&&B(e,"linked-bottom",f[1]==="linked-bottom"||f[1]==="linked-full")},i(f){I||(se(k),I=!0)},o(f){ve(k),I=!1},d(f){f&&T(e),y&&y.d(),w&&w.d(),b&&b.d(),k&&k.d(),_e=!1,Xe(ye)}}}function ll(l,e,n){let t,{$$slots:i={},$$scope:o}=e;const s=Je(i);let{post:r}=e,{interactive:u=void 0}=e,{type:_=void 0}=e,{showParent:g=!0}=e;const M=(m,P,...j)=>{u&&(m.classList.add("interactive"),m.addEventListener("click",()=>Ne(`#/user/${P.username}`)))},C=(m,P,...j)=>{u&&(m.classList.add("interactive"),m.addEventListener("click",()=>Ne(`#/post/${P.id}`)))},E=m=>{var P,j;let q=0;return q+=m.comments?m.comments.length+((j=(P=m.comments)===null||P===void 0?void 0:P.map(E).reduce((R,z)=>R+z,0))!==null&&j!==void 0?j:0):0,q};return l.$$set=m=>{"post"in m&&n(0,r=m.post),"interactive"in m&&n(7,u=m.interactive),"type"in m&&n(1,_=m.type),"showParent"in m&&n(2,g=m.showParent),"$$scope"in m&&n(8,o=m.$$scope)},l.$$.update=()=>{if(l.$$.dirty&1){e:n(3,t=E(r))}},[r,_,g,t,M,C,s,u,o,i]}class tl extends Fe{constructor(e){super();We(this,e,ll,el,Ye,{post:0,interactive:7,type:1,showParent:2})}}export default tl;
