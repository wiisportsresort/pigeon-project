import"./LargePostCard.svelte.css.proxy.js";import{SvelteComponent as Be,action_destroyer as K,append as a,attr as c,check_outros as De,compute_slots as Fe,create_slot as Ge,destroy_each as Je,detach as T,element as p,empty as Ke,group_outros as Oe,init as Qe,insert as N,is_function as O,run_all as Ve,safe_not_equal as We,set_data as C,space as b,text as v,toggle_class as B,transition_in as ne,transition_out as _e,update_slot as Xe}from"../../_snowpack/pkg/svelte/internal.js";import{format as se}from"../../_snowpack/pkg/date-fns.js";import{push as Te}from"../../_snowpack/pkg/svelte-spa-router.js";import{assert as D}from"../util.js";function Ne(l,e,n){const t=l.slice();return t[11]=e[n],t[13]=n,t}function Ee(l){let e;return{c(){e=p("div"),c(e,"class","link link-top svelte-zz40ej")},m(n,t){N(n,e,t)},d(n){n&&T(e)}}}function qe(l){var h;let e,n,t,i,r=((h=l[0].parent.author)==null?void 0:h.username)+"",s,o,u,_;return{c(){e=p("span"),n=v(`Replying to
        `),t=p("strong"),i=v("@"),s=v(r),c(t,"class","svelte-zz40ej"),c(e,"class","parent svelte-zz40ej")},m(w,I){N(w,e,I),a(e,n),a(e,t),a(t,i),a(t,s),u||(_=K(o=l[5].call(null,e,D(l[0].parent))),u=!0)},p(w,I){var E;I&1&&r!==(r=((E=w[0].parent.author)==null?void 0:E.username)+"")&&C(s,r),o&&O(o.update)&&I&1&&o.update.call(null,D(w[0].parent))},d(w){w&&T(e),u=!1,_()}}}function Re(l){let e,n=l[0].media,t=[];for(let i=0;i<n.length;i+=1)t[i]=Ue(Ne(l,n,i));return{c(){e=p("div");for(let i=0;i<t.length;i+=1)t[i].c();c(e,"class","media svelte-zz40ej")},m(i,r){N(i,e,r);for(let s=0;s<t.length;s+=1)t[s].m(e,null)},p(i,r){if(r&1){n=i[0].media;let s;for(s=0;s<n.length;s+=1){const o=Ne(i,n,s);t[s]?t[s].p(o,r):(t[s]=Ue(o),t[s].c(),t[s].m(e,null))}for(;s<t.length;s+=1)t[s].d(1);t.length=n.length}},d(i){i&&T(e),Je(t,i)}}}function Ye(l){let e,n,t=l[11].type+"",i,r,s=l[11].src+"",o,u;return{c(){e=p("span"),n=v("Unknown media type: "),i=v(t),r=v(" (src: "),o=v(s),u=v(")"),c(e,"class","svelte-zz40ej")},m(_,h){N(_,e,h),a(e,n),a(e,i),a(e,r),a(e,o),a(e,u)},p(_,h){h&1&&t!==(t=_[11].type+"")&&C(i,t),h&1&&s!==(s=_[11].src+"")&&C(o,s)},d(_){_&&T(e)}}}function Ze(l){let e,n,t,i,r,s,o=l[11].caption&&Se(l);return{c(){e=p("div"),n=p("img"),r=b(),o&&o.c(),s=b(),n.src!==(t=l[11].src)&&c(n,"src",t),c(n,"alt",i="attachment "+l[13]),c(n,"class","svelte-zz40ej"),c(e,"class","attachment svelte-zz40ej")},m(u,_){N(u,e,_),a(e,n),a(e,r),o&&o.m(e,null),a(e,s)},p(u,_){_&1&&n.src!==(t=u[11].src)&&c(n,"src",t),u[11].caption?o?o.p(u,_):(o=Se(u),o.c(),o.m(e,s)):o&&(o.d(1),o=null)},d(u){u&&T(e),o&&o.d()}}}function Se(l){let e,n=l[11].caption+"";return{c(){e=p("span"),c(e,"class","caption svelte-zz40ej")},m(t,i){N(t,e,i),e.innerHTML=n},p(t,i){i&1&&n!==(n=t[11].caption+"")&&(e.innerHTML=n)},d(t){t&&T(e)}}}function Ue(l){let e;function n(r,s){return r[11].type==="image"?Ze:Ye}let t=n(l,-1),i=t(l);return{c(){i.c(),e=Ke()},m(r,s){i.m(r,s),N(r,e,s)},p(r,s){t===(t=n(r,s))&&i?i.p(r,s):(i.d(1),i=t(r),i&&(i.c(),i.m(e.parentNode,e)))},d(r){i.d(r),r&&T(e)}}}function Ae(l){let e,n,t,i;const r=l[9].default,s=Ge(r,l,l[8],null);return{c(){e=p("div"),n=p("hr"),t=b(),s&&s.c(),c(n,"class","svelte-zz40ej")},m(o,u){N(o,e,u),a(e,n),a(e,t),s&&s.m(e,null),i=!0},p(o,u){s&&s.p&&u&256&&Xe(s,r,o,o[8],u,null,null)},i(o){i||(ne(s,o),i=!0)},o(o){_e(s,o),i=!1},d(o){o&&T(e),s&&s.d(o)}}}function $e(l){var Me,Ie;let e,n,t,i,r,s,o,u,_,h,w=((Me=l[0].author)==null?void 0:Me.displayName)+"",I,E,m,y,P=((Ie=l[0].author)==null?void 0:Ie.username)+"",R,S,U,ve,k,ae,F,Q=l[0].content+"",ze,ie,oe,re,ke,H,G,V,W=l[0].likes+"",fe,he,ge,q,X,ue,je,Y=(l[3]===1?"":"s")+"",ce,Z,be,A,$,x=se(l[0].timestamp,"MMM d, yyy")+"",pe,we,ee,le=se(l[0].timestamp,"h:mm a")+"",me,te,L,de,Le,M=(l[1]==="linked-top"||l[1]==="linked-full")&&Ee(l),g=l[2]&&l[0].parent&&qe(l),j=l[0].media.length&&Re(l),z=l[6].default&&Ae(l);return{c(){var f,d,J;e=p("div"),n=p("header"),t=p("aside"),M&&M.c(),i=b(),r=p("img"),o=b(),u=p("aside"),_=p("span"),h=p("b"),I=v(w),E=b(),m=p("span"),y=v("@"),R=v(P),ve=b(),k=p("div"),g&&g.c(),ae=b(),F=p("span"),ze=b(),j&&j.c(),ie=b(),z&&z.c(),oe=b(),re=p("hr"),ke=b(),H=p("div"),G=p("span"),V=p("strong"),fe=v(W),he=v(`
        points`),ge=b(),q=p("span"),X=p("strong"),ue=v(l[3]),je=v(`
        comment`),ce=v(Y),be=b(),A=p("span"),$=p("span"),pe=v(x),we=v(`
        \xA0\xB7\xA0
        `),ee=p("span"),me=v(le),r.src!==(s=(J=(d=(f=l[0].author)==null?void 0:f.profileImage)==null?void 0:d.src)!=null?J:"default.png")&&c(r,"src",s),c(r,"alt","profile"),c(r,"class","svelte-zz40ej"),c(t,"class","svelte-zz40ej"),c(_,"class","header svelte-zz40ej"),c(m,"class","gray svelte-zz40ej"),c(u,"class","svelte-zz40ej"),c(n,"class","svelte-zz40ej"),c(F,"class","content svelte-zz40ej"),c(re,"class","svelte-zz40ej"),c(V,"class","svelte-zz40ej"),c(G,"class","likes svelte-zz40ej"),c(X,"class","svelte-zz40ej"),c(q,"class","comments svelte-zz40ej"),c($,"class","gray svelte-zz40ej"),c(ee,"class","gray svelte-zz40ej"),c(A,"class","timestamp svelte-zz40ej"),c(H,"class","interactions svelte-zz40ej"),c(k,"class","body svelte-zz40ej"),c(e,"class","large-post-card svelte-zz40ej"),B(e,"is-reply",l[2]&&!!l[0].parent),B(e,"linked-top",l[1]==="linked-top"||l[1]==="linked-full"),B(e,"linked-bottom",l[1]==="linked-bottom"||l[1]==="linked-full")},m(f,d){N(f,e,d),a(e,n),a(n,t),M&&M.m(t,null),a(t,i),a(t,r),a(n,o),a(n,u),a(u,_),a(_,h),a(h,I),a(u,E),a(u,m),a(m,y),a(m,R),a(e,ve),a(e,k),g&&g.m(k,null),a(k,ae),a(k,F),F.innerHTML=Q,a(k,ze),j&&j.m(k,null),a(k,ie),z&&z.m(k,null),a(k,oe),a(k,re),a(k,ke),a(k,H),a(H,G),a(G,V),a(V,fe),a(G,he),a(H,ge),a(H,q),a(q,X),a(X,ue),a(q,je),a(q,ce),a(H,be),a(H,A),a(A,$),a($,pe),a(A,we),a(A,ee),a(ee,me),L=!0,de||(Le=[K(S=l[4].call(null,u,D(l[0].author))),K(U=l[4].call(null,n,D(l[0].author))),K(Z=l[5].call(null,q,l[0])),K(te=l[5].call(null,H,l[0]))],de=!0)},p(f,[d]){var J,ye,Pe,Ce,He;f[1]==="linked-top"||f[1]==="linked-full"?M||(M=Ee(f),M.c(),M.m(t,i)):M&&(M.d(1),M=null),(!L||d&1&&r.src!==(s=(Pe=(ye=(J=f[0].author)==null?void 0:J.profileImage)==null?void 0:ye.src)!=null?Pe:"default.png"))&&c(r,"src",s),(!L||d&1)&&w!==(w=((Ce=f[0].author)==null?void 0:Ce.displayName)+"")&&C(I,w),(!L||d&1)&&P!==(P=((He=f[0].author)==null?void 0:He.username)+"")&&C(R,P),S&&O(S.update)&&d&1&&S.update.call(null,D(f[0].author)),U&&O(U.update)&&d&1&&U.update.call(null,D(f[0].author)),f[2]&&f[0].parent?g?g.p(f,d):(g=qe(f),g.c(),g.m(k,ae)):g&&(g.d(1),g=null),(!L||d&1)&&Q!==(Q=f[0].content+"")&&(F.innerHTML=Q),f[0].media.length?j?j.p(f,d):(j=Re(f),j.c(),j.m(k,ie)):j&&(j.d(1),j=null),f[6].default?z?(z.p(f,d),d&64&&ne(z,1)):(z=Ae(f),z.c(),ne(z,1),z.m(k,oe)):z&&(Oe(),_e(z,1,1,()=>{z=null}),De()),(!L||d&1)&&W!==(W=f[0].likes+"")&&C(fe,W),(!L||d&8)&&C(ue,f[3]),(!L||d&8)&&Y!==(Y=(f[3]===1?"":"s")+"")&&C(ce,Y),Z&&O(Z.update)&&d&1&&Z.update.call(null,f[0]),(!L||d&1)&&x!==(x=se(f[0].timestamp,"MMM d, yyy")+"")&&C(pe,x),(!L||d&1)&&le!==(le=se(f[0].timestamp,"h:mm a")+"")&&C(me,le),te&&O(te.update)&&d&1&&te.update.call(null,f[0]),d&5&&B(e,"is-reply",f[2]&&!!f[0].parent),d&2&&B(e,"linked-top",f[1]==="linked-top"||f[1]==="linked-full"),d&2&&B(e,"linked-bottom",f[1]==="linked-bottom"||f[1]==="linked-full")},i(f){L||(ne(z),L=!0)},o(f){_e(z),L=!1},d(f){f&&T(e),M&&M.d(),g&&g.d(),j&&j.d(),z&&z.d(),de=!1,Ve(Le)}}}function xe(l,e,n){let t,{$$slots:i={},$$scope:r}=e;const s=Fe(i);let{post:o}=e,{interactive:u=void 0}=e,{type:_=void 0}=e,{showParent:h=!0}=e;const w=(m,y,...P)=>{u&&(m.classList.add("interactive"),m.addEventListener("click",()=>Te(`#/user/${y.username}`)))},I=(m,y,...P)=>{u&&(m.classList.add("interactive"),m.addEventListener("click",()=>Te(`#/post/${y.id}`)))},E=m=>{var y,P;let R=0;return R+=m.comments?m.comments.length+((P=(y=m.comments)===null||y===void 0?void 0:y.map(E).reduce((S,U)=>S+U,0))!==null&&P!==void 0?P:0):0,R};return l.$$set=m=>{"post"in m&&n(0,o=m.post),"interactive"in m&&n(7,u=m.interactive),"type"in m&&n(1,_=m.type),"showParent"in m&&n(2,h=m.showParent),"$$scope"in m&&n(8,r=m.$$scope)},l.$$.update=()=>{if(l.$$.dirty&1){e:n(3,t=E(o))}},[o,_,h,t,w,I,s,u,r,i]}class el extends Be{constructor(e){super();Qe(this,e,xe,$e,We,{post:0,interactive:7,type:1,showParent:2})}}export default el;
