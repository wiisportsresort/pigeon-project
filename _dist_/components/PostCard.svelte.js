import"./PostCard.svelte.css.proxy.js";import{SvelteComponent as Ue,action_destroyer as T,append as n,attr as c,check_outros as Ve,compute_slots as We,create_component as ge,create_slot as Xe,destroy_component as he,detach as Q,element as d,group_outros as Ye,init as Ze,insert as U,is_function as R,mount_component as be,run_all as ye,safe_not_equal as $e,set_data as S,space as k,text as M,toggle_class as z,transition_in as D,transition_out as V,update_slot as xe}from"../../_snowpack/pkg/svelte/internal.js";import{format as De}from"../../_snowpack/pkg/date-fns.js";import{push as Fe}from"../../_snowpack/pkg/svelte-spa-router.js";import{assert as W}from"../util.js";import we from"./Icon.svelte.js";function Ge(e){let l;return{c(){l=d("div"),c(l,"class","link link-top svelte-8x2t1u")},m(i,r){U(i,l,r)},d(i){i&&Q(l)}}}function Je(e){let l;return{c(){l=d("div"),c(l,"class","link link-bottom svelte-8x2t1u")},m(i,r){U(i,l,r)},d(i){i&&Q(l)}}}function Ke(e){var C;let l,i,r,_,p=((C=e[0].parent.author)==null?void 0:C.username)+"",u,a,m,b;return{c(){l=d("span"),i=M(`Replying to
        `),r=d("strong"),_=M("@"),u=M(p),c(r,"class","svelte-8x2t1u"),c(l,"class","parent svelte-8x2t1u")},m(L,o){U(L,l,o),n(l,i),n(l,r),n(r,_),n(r,u),m||(b=T(a=e[5].call(null,l,W(e[0].parent))),m=!0)},p(L,o){var s;o&1&&p!==(p=((s=L[0].parent.author)==null?void 0:s.username)+"")&&S(u,p),a&&R(a.update)&&o&1&&a.update.call(null,W(L[0].parent))},d(L){L&&Q(l),m=!1,b()}}}function Oe(e){let l,i,r=e[0].media.length+"",_,p,u=(e[0].media.length===1?"":"s")+"",a;return{c(){l=d("span"),i=d("i"),_=M(r),p=M(" attachment"),a=M(u),c(l,"class","media-preview gray svelte-8x2t1u")},m(m,b){U(m,l,b),n(l,i),n(i,_),n(i,p),n(i,a)},p(m,b){b&1&&r!==(r=m[0].media.length+"")&&S(_,r),b&1&&u!==(u=(m[0].media.length===1?"":"s")+"")&&S(a,u)},d(m){m&&Q(l)}}}function Qe(e){let l,i,r,_;const p=e[9].default,u=Xe(p,e,e[8],null);return{c(){l=d("div"),i=d("hr"),r=k(),u&&u.c(),c(l,"class","svelte-8x2t1u")},m(a,m){U(a,l,m),n(l,i),n(l,r),u&&u.m(l,null),_=!0},p(a,m){u&&u.p&&m&256&&xe(u,p,a,a[8],m,null,null)},i(a){_||(D(u,a),_=!0)},o(a){V(u,a),_=!1},d(a){a&&Q(l),u&&u.d(a)}}}function el(e){var Te,Re;let l,i,r,_,p,u,a,m,b,C,L,o,s,j,E,F,H,q,ue,Z=((Te=e[0].author)==null?void 0:Te.displayName)+"",oe,Ie,X,Me,y=((Re=e[0].author)==null?void 0:Re.username)+"",fe,$,je,x,ee=De(e[0].timestamp,"MMM d, yyy")+"",re,Le,G,le=e[0].content+"",te,Pe,de,pe,A,N,J,Ce,me,ne=e[0].likes+"",ce,qe,K,Ee,B,O,He,ve,ae=e[6](e[0])+"",_e,ie,se,P,ke,Ne,w=(e[2]==="linked-top"||e[2]==="linked-full")&&Ge(e),I=(e[2]==="linked-bottom"||e[2]==="linked-full")&&Je(e),g=e[3]&&e[0].parent&&Ke(e),h=e[0].media.length&&Oe(e),v=e[7].default&&Qe(e);return J=new we({props:{icon:"arrow-up"}}),K=new we({props:{icon:"arrow-down"}}),O=new we({props:{icon:"message-square"}}),{c(){var t,f,Y;l=d("div"),i=d("div"),_=k(),p=d("div"),w&&w.c(),u=k(),a=d("img"),b=k(),I&&I.c(),L=k(),o=d("div"),s=d("div"),E=k(),g&&g.c(),F=k(),H=d("span"),q=d("div"),ue=d("b"),oe=M(Z),Ie=k(),X=d("span"),Me=M("@"),fe=M(y),je=M(`
      \xA0\xB7\xA0
      `),x=d("span"),re=M(ee),Le=k(),G=d("span"),Pe=k(),h&&h.c(),de=k(),v&&v.c(),pe=k(),A=d("div"),N=d("span"),ge(J.$$.fragment),Ce=k(),me=d("span"),ce=M(ne),qe=k(),ge(K.$$.fragment),Ee=k(),B=d("span"),ge(O.$$.fragment),He=k(),ve=d("span"),_e=M(ae),c(i,"class","post-background svelte-8x2t1u"),a.src!==(m=(Y=(f=(t=e[0].author)==null?void 0:t.profileImage)==null?void 0:f.src)!=null?Y:"default.png")&&c(a,"src",m),c(a,"alt","profile"),c(a,"class","svelte-8x2t1u"),c(p,"class","image-col svelte-8x2t1u"),c(s,"class","post-background svelte-8x2t1u"),c(X,"class","gray svelte-8x2t1u"),c(q,"class","username"),c(x,"class","gray svelte-8x2t1u"),c(H,"class","header svelte-8x2t1u"),c(G,"class","content svelte-8x2t1u"),c(N,"class","likes svelte-8x2t1u"),c(B,"class","comments svelte-8x2t1u"),c(A,"class","interactions svelte-8x2t1u"),c(o,"class","body svelte-8x2t1u"),c(l,"class","post-card svelte-8x2t1u"),z(l,"interactive",e[1]==="full"),z(l,"is-reply",e[3]&&!!e[0].parent),z(l,"linked-top",e[2]==="linked-top"||e[2]==="linked-full"),z(l,"linked-bottom",e[2]==="linked-bottom"||e[2]==="linked-full")},m(t,f){U(t,l,f),n(l,i),n(l,_),n(l,p),w&&w.m(p,null),n(p,u),n(p,a),n(p,b),I&&I.m(p,null),n(l,L),n(l,o),n(o,s),n(o,E),g&&g.m(o,null),n(o,F),n(o,H),n(H,q),n(q,ue),n(ue,oe),n(q,Ie),n(q,X),n(X,Me),n(X,fe),n(H,je),n(H,x),n(x,re),n(o,Le),n(o,G),G.innerHTML=le,n(o,Pe),h&&h.m(o,null),n(o,de),v&&v.m(o,null),n(o,pe),n(o,A),n(A,N),be(J,N,null),n(N,Ce),n(N,me),n(me,ce),n(N,qe),be(K,N,null),n(A,Ee),n(A,B),be(O,B,null),n(B,He),n(B,ve),n(ve,_e),P=!0,ke||(Ne=[T(r=e[5].call(null,i,e[0])),T(C=e[4].call(null,p,W(e[0].author))),T(j=e[5].call(null,s,e[0])),T($=e[4].call(null,q,W(e[0].author))),T(te=e[5].call(null,G,e[0])),T(ie=e[5].call(null,B,e[0])),T(se=e[5].call(null,A,e[0]))],ke=!0)},p(t,[f]){var Y,Se,ze,Ae,Be;r&&R(r.update)&&f&1&&r.update.call(null,t[0]),t[2]==="linked-top"||t[2]==="linked-full"?w||(w=Ge(t),w.c(),w.m(p,u)):w&&(w.d(1),w=null),(!P||f&1&&a.src!==(m=(ze=(Se=(Y=t[0].author)==null?void 0:Y.profileImage)==null?void 0:Se.src)!=null?ze:"default.png"))&&c(a,"src",m),t[2]==="linked-bottom"||t[2]==="linked-full"?I||(I=Je(t),I.c(),I.m(p,null)):I&&(I.d(1),I=null),C&&R(C.update)&&f&1&&C.update.call(null,W(t[0].author)),j&&R(j.update)&&f&1&&j.update.call(null,t[0]),t[3]&&t[0].parent?g?g.p(t,f):(g=Ke(t),g.c(),g.m(o,F)):g&&(g.d(1),g=null),(!P||f&1)&&Z!==(Z=((Ae=t[0].author)==null?void 0:Ae.displayName)+"")&&S(oe,Z),(!P||f&1)&&y!==(y=((Be=t[0].author)==null?void 0:Be.username)+"")&&S(fe,y),$&&R($.update)&&f&1&&$.update.call(null,W(t[0].author)),(!P||f&1)&&ee!==(ee=De(t[0].timestamp,"MMM d, yyy")+"")&&S(re,ee),(!P||f&1)&&le!==(le=t[0].content+"")&&(G.innerHTML=le),te&&R(te.update)&&f&1&&te.update.call(null,t[0]),t[0].media.length?h?h.p(t,f):(h=Oe(t),h.c(),h.m(o,de)):h&&(h.d(1),h=null),t[7].default?v?(v.p(t,f),f&128&&D(v,1)):(v=Qe(t),v.c(),D(v,1),v.m(o,pe)):v&&(Ye(),V(v,1,1,()=>{v=null}),Ve()),(!P||f&1)&&ne!==(ne=t[0].likes+"")&&S(ce,ne),(!P||f&1)&&ae!==(ae=t[6](t[0])+"")&&S(_e,ae),ie&&R(ie.update)&&f&1&&ie.update.call(null,t[0]),se&&R(se.update)&&f&1&&se.update.call(null,t[0]),f&2&&z(l,"interactive",t[1]==="full"),f&9&&z(l,"is-reply",t[3]&&!!t[0].parent),f&4&&z(l,"linked-top",t[2]==="linked-top"||t[2]==="linked-full"),f&4&&z(l,"linked-bottom",t[2]==="linked-bottom"||t[2]==="linked-full")},i(t){P||(D(v),D(J.$$.fragment,t),D(K.$$.fragment,t),D(O.$$.fragment,t),P=!0)},o(t){V(v),V(J.$$.fragment,t),V(K.$$.fragment,t),V(O.$$.fragment,t),P=!1},d(t){t&&Q(l),w&&w.d(),I&&I.d(),g&&g.d(),h&&h.d(),v&&v.d(),he(J),he(K),he(O),ke=!1,ye(Ne)}}}function ll(e,l,i){let{$$slots:r={},$$scope:_}=l;const p=We(r);let{post:u}=l,{interactive:a=void 0}=l,{type:m=void 0}=l,{showParent:b=!0}=l;const C=(s,j,...E)=>{a&&(s.classList.add("interactive"),s.addEventListener("click",()=>Fe(`#/user/${j.username}`)))},L=(s,j,...E)=>{a==="full"&&(s.classList.add("interactive"),s.addEventListener("click",()=>Fe(`#/post/${j.id}`)))},o=s=>{var j,E;let F=0;return F+=s.comments?s.comments.length+((E=(j=s.comments)===null||j===void 0?void 0:j.map(o).reduce((H,q)=>H+q,0))!==null&&E!==void 0?E:0):0,F};return e.$$set=s=>{"post"in s&&i(0,u=s.post),"interactive"in s&&i(1,a=s.interactive),"type"in s&&i(2,m=s.type),"showParent"in s&&i(3,b=s.showParent),"$$scope"in s&&i(8,_=s.$$scope)},[u,a,m,b,C,L,o,p,_,r]}class tl extends Ue{constructor(l){super();Ze(this,l,ll,el,$e,{post:0,interactive:1,type:2,showParent:3})}}export default tl;
