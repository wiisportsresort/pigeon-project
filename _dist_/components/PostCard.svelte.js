import"./PostCard.svelte.css.proxy.js";import{SvelteComponent as Ve,action_destroyer as H,append as n,attr as o,check_outros as We,compute_slots as Xe,create_component as ge,create_slot as Ye,destroy_component as he,detach as O,element as p,group_outros as Ze,init as ye,insert as Q,is_function as N,mount_component as qe,run_all as $e,safe_not_equal as xe,set_data as T,space as k,text as w,toggle_class as R,transition_in as B,transition_out as V,update_slot as el}from"../../_snowpack/pkg/svelte/internal.js";import{format as Be}from"../../_snowpack/pkg/date-fns.js";import{push as De}from"../../_snowpack/pkg/svelte-spa-router.js";import{assert as W,formatUserContent as Fe}from"../util.js";import ze from"./Icon.svelte.js";function Ge(e){let l;return{c(){l=p("div"),o(l,"class","link link-top svelte-112xqz2")},m(s,d){Q(s,l,d)},d(s){s&&O(l)}}}function Je(e){let l;return{c(){l=p("div"),o(l,"class","link link-bottom svelte-112xqz2")},m(s,d){Q(s,l,d)},d(s){s&&O(l)}}}function Ke(e){var j;let l,s,d,v,m=((j=e[0].parent.author)==null?void 0:j.username)+"",u,a,c,q;return{c(){l=p("span"),s=w(`Replying to
        `),d=p("strong"),v=w("@"),u=w(m),o(d,"class","svelte-112xqz2"),o(l,"class","parent svelte-112xqz2")},m(L,f){Q(L,l,f),n(l,s),n(l,d),n(d,v),n(d,u),c||(q=H(a=e[5].call(null,l,W(e[0].parent))),c=!0)},p(L,f){var i;f&1&&m!==(m=((i=L[0].parent.author)==null?void 0:i.username)+"")&&T(u,m),a&&N(a.update)&&f&1&&a.update.call(null,W(L[0].parent))},d(L){L&&O(l),c=!1,q()}}}function Oe(e){let l,s,d=e[0].media.length+"",v,m,u=(e[0].media.length===1?"":"s")+"",a;return{c(){l=p("span"),s=p("i"),v=w(d),m=w(" attachment"),a=w(u),o(s,"class","svelte-112xqz2"),o(l,"class","media-preview gray svelte-112xqz2")},m(c,q){Q(c,l,q),n(l,s),n(s,v),n(s,m),n(s,a)},p(c,q){q&1&&d!==(d=c[0].media.length+"")&&T(v,d),q&1&&u!==(u=(c[0].media.length===1?"":"s")+"")&&T(a,u)},d(c){c&&O(l)}}}function Qe(e){let l,s,d,v;const m=e[9].default,u=Ye(m,e,e[8],null);return{c(){l=p("div"),s=p("hr"),d=k(),u&&u.c(),o(s,"class","svelte-112xqz2"),o(l,"class","svelte-112xqz2")},m(a,c){Q(a,l,c),n(l,s),n(l,d),u&&u.m(l,null),v=!0},p(a,c){u&&u.p&&(!v||c&256)&&el(u,m,a,a[8],c,null,null)},i(a){v||(B(u,a),v=!0)},o(a){V(u,a),v=!1},d(a){a&&O(l),u&&u.d(a)}}}function ll(e){var He,Ne;let l,s,d,v,m,u,a,c,q,j,L,f,i,I,C,D,S,P,Z,y=((He=e[0].author)==null?void 0:He.displayName)+"",re,be,X,we,$=((Ne=e[0].author)==null?void 0:Ne.username)+"",de,x,Ie,ee,le=Be(e[0].timestamp,"MMM d, yyy")+"",pe,Le,F,te=Fe(e[0].content)+"",ne,Me,me,ce,U,E,G,je,ae,se=e[0].likes.toLocaleString()+"",ve,Pe,J,Ce,A,K,Se,ie,oe=e[6](e[0]).toLocaleString()+"",_e,ue,fe,M,ke,Ee,z=(e[2]==="linked-top"||e[2]==="linked-full")&&Ge(e),b=(e[2]==="linked-bottom"||e[2]==="linked-full")&&Je(e),g=e[3]&&e[0].parent&&Ke(e),h=e[0].media.length&&Oe(e),_=e[7].default&&Qe(e);return G=new ze({props:{icon:"arrow-up"}}),J=new ze({props:{icon:"arrow-down"}}),K=new ze({props:{icon:"message-square"}}),{c(){var t,r,Y;l=p("div"),s=p("div"),v=k(),m=p("div"),z&&z.c(),u=k(),a=p("img"),q=k(),b&&b.c(),L=k(),f=p("div"),i=p("div"),C=k(),g&&g.c(),D=k(),S=p("span"),P=p("div"),Z=p("b"),re=w(y),be=k(),X=p("span"),we=w("@"),de=w($),Ie=w(`
       · 
      `),ee=p("span"),pe=w(le),Le=k(),F=p("span"),Me=k(),h&&h.c(),me=k(),_&&_.c(),ce=k(),U=p("div"),E=p("span"),ge(G.$$.fragment),je=k(),ae=p("span"),ve=w(se),Pe=k(),ge(J.$$.fragment),Ce=k(),A=p("span"),ge(K.$$.fragment),Se=k(),ie=p("span"),_e=w(oe),o(s,"class","post-background svelte-112xqz2"),a.src!==(c=(Y=(r=(t=e[0].author)==null?void 0:t.profileImage)==null?void 0:r.src)!=null?Y:"default.png")&&o(a,"src",c),o(a,"alt","profile"),o(a,"class","svelte-112xqz2"),o(m,"class","image-col svelte-112xqz2"),o(i,"class","post-background svelte-112xqz2"),o(Z,"class","svelte-112xqz2"),o(X,"class","gray svelte-112xqz2"),o(P,"class","username svelte-112xqz2"),o(ee,"class","gray svelte-112xqz2"),o(S,"class","header svelte-112xqz2"),o(F,"class","content svelte-112xqz2"),o(ae,"class","svelte-112xqz2"),o(E,"class","likes svelte-112xqz2"),o(ie,"class","svelte-112xqz2"),o(A,"class","comments svelte-112xqz2"),o(U,"class","interactions svelte-112xqz2"),o(f,"class","body svelte-112xqz2"),o(l,"class","post-card svelte-112xqz2"),R(l,"interactive",e[1]==="full"),R(l,"is-reply",e[3]&&!!e[0].parent),R(l,"linked-top",e[2]==="linked-top"||e[2]==="linked-full"),R(l,"linked-bottom",e[2]==="linked-bottom"||e[2]==="linked-full")},m(t,r){Q(t,l,r),n(l,s),n(l,v),n(l,m),z&&z.m(m,null),n(m,u),n(m,a),n(m,q),b&&b.m(m,null),n(l,L),n(l,f),n(f,i),n(f,C),g&&g.m(f,null),n(f,D),n(f,S),n(S,P),n(P,Z),n(Z,re),n(P,be),n(P,X),n(X,we),n(X,de),n(S,Ie),n(S,ee),n(ee,pe),n(f,Le),n(f,F),F.innerHTML=te,n(f,Me),h&&h.m(f,null),n(f,me),_&&_.m(f,null),n(f,ce),n(f,U),n(U,E),qe(G,E,null),n(E,je),n(E,ae),n(ae,ve),n(E,Pe),qe(J,E,null),n(U,Ce),n(U,A),qe(K,A,null),n(A,Se),n(A,ie),n(ie,_e),M=!0,ke||(Ee=[H(d=e[5].call(null,s,e[0])),H(j=e[4].call(null,m,W(e[0].author))),H(I=e[5].call(null,i,e[0])),H(x=e[4].call(null,P,W(e[0].author))),H(ne=e[5].call(null,F,e[0])),H(ue=e[5].call(null,A,e[0])),H(fe=e[5].call(null,U,e[0]))],ke=!0)},p(t,[r]){var Y,Te,Re,Ue,Ae;d&&N(d.update)&&r&1&&d.update.call(null,t[0]),t[2]==="linked-top"||t[2]==="linked-full"?z||(z=Ge(t),z.c(),z.m(m,u)):z&&(z.d(1),z=null),(!M||r&1&&a.src!==(c=(Re=(Te=(Y=t[0].author)==null?void 0:Y.profileImage)==null?void 0:Te.src)!=null?Re:"default.png"))&&o(a,"src",c),t[2]==="linked-bottom"||t[2]==="linked-full"?b||(b=Je(t),b.c(),b.m(m,null)):b&&(b.d(1),b=null),j&&N(j.update)&&r&1&&j.update.call(null,W(t[0].author)),I&&N(I.update)&&r&1&&I.update.call(null,t[0]),t[3]&&t[0].parent?g?g.p(t,r):(g=Ke(t),g.c(),g.m(f,D)):g&&(g.d(1),g=null),(!M||r&1)&&y!==(y=((Ue=t[0].author)==null?void 0:Ue.displayName)+"")&&T(re,y),(!M||r&1)&&$!==($=((Ae=t[0].author)==null?void 0:Ae.username)+"")&&T(de,$),x&&N(x.update)&&r&1&&x.update.call(null,W(t[0].author)),(!M||r&1)&&le!==(le=Be(t[0].timestamp,"MMM d, yyy")+"")&&T(pe,le),(!M||r&1)&&te!==(te=Fe(t[0].content)+"")&&(F.innerHTML=te),ne&&N(ne.update)&&r&1&&ne.update.call(null,t[0]),t[0].media.length?h?h.p(t,r):(h=Oe(t),h.c(),h.m(f,me)):h&&(h.d(1),h=null),t[7].default?_?(_.p(t,r),r&128&&B(_,1)):(_=Qe(t),_.c(),B(_,1),_.m(f,ce)):_&&(Ze(),V(_,1,1,()=>{_=null}),We()),(!M||r&1)&&se!==(se=t[0].likes.toLocaleString()+"")&&T(ve,se),(!M||r&1)&&oe!==(oe=t[6](t[0]).toLocaleString()+"")&&T(_e,oe),ue&&N(ue.update)&&r&1&&ue.update.call(null,t[0]),fe&&N(fe.update)&&r&1&&fe.update.call(null,t[0]),r&2&&R(l,"interactive",t[1]==="full"),r&9&&R(l,"is-reply",t[3]&&!!t[0].parent),r&4&&R(l,"linked-top",t[2]==="linked-top"||t[2]==="linked-full"),r&4&&R(l,"linked-bottom",t[2]==="linked-bottom"||t[2]==="linked-full")},i(t){M||(B(_),B(G.$$.fragment,t),B(J.$$.fragment,t),B(K.$$.fragment,t),M=!0)},o(t){V(_),V(G.$$.fragment,t),V(J.$$.fragment,t),V(K.$$.fragment,t),M=!1},d(t){t&&O(l),z&&z.d(),b&&b.d(),g&&g.d(),h&&h.d(),_&&_.d(),he(G),he(J),he(K),ke=!1,$e(Ee)}}}function tl(e,l,s){let{$$slots:d={},$$scope:v}=l;const m=Xe(d);let{post:u}=l,{interactive:a=void 0}=l,{type:c=void 0}=l,{showParent:q=!0}=l;const j=(i,I,...C)=>{a&&(i.classList.add("interactive"),i.addEventListener("click",()=>De(`#/user/${I.username}`)))},L=(i,I,...C)=>{a==="full"&&(i.classList.add("interactive"),i.addEventListener("click",()=>De(`#/post/${I.id}`)))},f=i=>{var I,C;let D=0;return D+=i.comments?i.comments.length+((C=(I=i.comments)===null||I===void 0?void 0:I.map(f).reduce((S,P)=>S+P,0))!==null&&C!==void 0?C:0):0,D};return e.$$set=i=>{"post"in i&&s(0,u=i.post),"interactive"in i&&s(1,a=i.interactive),"type"in i&&s(2,c=i.type),"showParent"in i&&s(3,q=i.showParent),"$$scope"in i&&s(8,v=i.$$scope)},[u,a,c,q,j,L,f,m,v,d]}class nl extends Ve{constructor(l){super();ye(this,l,tl,ll,xe,{post:0,interactive:1,type:2,showParent:3})}}export default nl;
