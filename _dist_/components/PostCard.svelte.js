import"./PostCard.svelte.css.proxy.js";import{SvelteComponent as Ve,action_destroyer as H,append as n,attr as c,check_outros as We,compute_slots as Xe,create_component as ge,create_slot as Ye,destroy_component as he,detach as O,element as d,group_outros as Ze,init as ye,insert as Q,is_function as N,mount_component as be,run_all as $e,safe_not_equal as xe,set_data as T,space as k,text as w,toggle_class as R,transition_in as B,transition_out as V,update_slot as el}from"../../_snowpack/pkg/svelte/internal.js";import{format as Be}from"../../_snowpack/pkg/date-fns.js";import{push as De}from"../../_snowpack/pkg/svelte-spa-router.js";import{assert as W,formatUserContent as Fe}from"../util.js";import qe from"./Icon.svelte.js";function Ge(e){let l;return{c(){l=d("div"),c(l,"class","link link-top svelte-112xqz2")},m(i,r){Q(i,l,r)},d(i){i&&O(l)}}}function Je(e){let l;return{c(){l=d("div"),c(l,"class","link link-bottom svelte-112xqz2")},m(i,r){Q(i,l,r)},d(i){i&&O(l)}}}function Ke(e){var j;let l,i,r,_,p=((j=e[0].parent.author)==null?void 0:j.username)+"",o,a,m,b;return{c(){l=d("span"),i=w(`Replying to
        `),r=d("strong"),_=w("@"),o=w(p),c(r,"class","svelte-112xqz2"),c(l,"class","parent svelte-112xqz2")},m(L,u){Q(L,l,u),n(l,i),n(l,r),n(r,_),n(r,o),m||(b=H(a=e[5].call(null,l,W(e[0].parent))),m=!0)},p(L,u){var s;u&1&&p!==(p=((s=L[0].parent.author)==null?void 0:s.username)+"")&&T(o,p),a&&N(a.update)&&u&1&&a.update.call(null,W(L[0].parent))},d(L){L&&O(l),m=!1,b()}}}function Oe(e){let l,i,r=e[0].media.length+"",_,p,o=(e[0].media.length===1?"":"s")+"",a;return{c(){l=d("span"),i=d("i"),_=w(r),p=w(" attachment"),a=w(o),c(l,"class","media-preview gray svelte-112xqz2")},m(m,b){Q(m,l,b),n(l,i),n(i,_),n(i,p),n(i,a)},p(m,b){b&1&&r!==(r=m[0].media.length+"")&&T(_,r),b&1&&o!==(o=(m[0].media.length===1?"":"s")+"")&&T(a,o)},d(m){m&&O(l)}}}function Qe(e){let l,i,r,_;const p=e[9].default,o=Ye(p,e,e[8],null);return{c(){l=d("div"),i=d("hr"),r=k(),o&&o.c(),c(l,"class","svelte-112xqz2")},m(a,m){Q(a,l,m),n(l,i),n(l,r),o&&o.m(l,null),_=!0},p(a,m){o&&o.p&&m&256&&el(o,p,a,a[8],m,null,null)},i(a){_||(B(o,a),_=!0)},o(a){V(o,a),_=!1},d(a){a&&O(l),o&&o.d(a)}}}function ll(e){var He,Ne;let l,i,r,_,p,o,a,m,b,j,L,u,s,I,C,D,S,P,oe,Z=((He=e[0].author)==null?void 0:He.displayName)+"",ue,ze,X,we,y=((Ne=e[0].author)==null?void 0:Ne.username)+"",fe,$,Ie,x,ee=Be(e[0].timestamp,"MMM d, yyy")+"",re,Le,F,le=Fe(e[0].content)+"",te,Me,de,pe,U,E,G,je,me,ne=e[0].likes.toLocaleString()+"",ce,Pe,J,Ce,A,K,Se,ve,ae=e[6](e[0]).toLocaleString()+"",_e,ie,se,M,ke,Ee,q=(e[2]==="linked-top"||e[2]==="linked-full")&&Ge(e),z=(e[2]==="linked-bottom"||e[2]==="linked-full")&&Je(e),g=e[3]&&e[0].parent&&Ke(e),h=e[0].media.length&&Oe(e),v=e[7].default&&Qe(e);return G=new qe({props:{icon:"arrow-up"}}),J=new qe({props:{icon:"arrow-down"}}),K=new qe({props:{icon:"message-square"}}),{c(){var t,f,Y;l=d("div"),i=d("div"),_=k(),p=d("div"),q&&q.c(),o=k(),a=d("img"),b=k(),z&&z.c(),L=k(),u=d("div"),s=d("div"),C=k(),g&&g.c(),D=k(),S=d("span"),P=d("div"),oe=d("b"),ue=w(Z),ze=k(),X=d("span"),we=w("@"),fe=w(y),Ie=w(`
      \xA0\xB7\xA0
      `),x=d("span"),re=w(ee),Le=k(),F=d("span"),Me=k(),h&&h.c(),de=k(),v&&v.c(),pe=k(),U=d("div"),E=d("span"),ge(G.$$.fragment),je=k(),me=d("span"),ce=w(ne),Pe=k(),ge(J.$$.fragment),Ce=k(),A=d("span"),ge(K.$$.fragment),Se=k(),ve=d("span"),_e=w(ae),c(i,"class","post-background svelte-112xqz2"),a.src!==(m=(Y=(f=(t=e[0].author)==null?void 0:t.profileImage)==null?void 0:f.src)!=null?Y:"default.png")&&c(a,"src",m),c(a,"alt","profile"),c(a,"class","svelte-112xqz2"),c(p,"class","image-col svelte-112xqz2"),c(s,"class","post-background svelte-112xqz2"),c(X,"class","gray svelte-112xqz2"),c(P,"class","username"),c(x,"class","gray svelte-112xqz2"),c(S,"class","header svelte-112xqz2"),c(F,"class","content svelte-112xqz2"),c(E,"class","likes svelte-112xqz2"),c(A,"class","comments svelte-112xqz2"),c(U,"class","interactions svelte-112xqz2"),c(u,"class","body svelte-112xqz2"),c(l,"class","post-card svelte-112xqz2"),R(l,"interactive",e[1]==="full"),R(l,"is-reply",e[3]&&!!e[0].parent),R(l,"linked-top",e[2]==="linked-top"||e[2]==="linked-full"),R(l,"linked-bottom",e[2]==="linked-bottom"||e[2]==="linked-full")},m(t,f){Q(t,l,f),n(l,i),n(l,_),n(l,p),q&&q.m(p,null),n(p,o),n(p,a),n(p,b),z&&z.m(p,null),n(l,L),n(l,u),n(u,s),n(u,C),g&&g.m(u,null),n(u,D),n(u,S),n(S,P),n(P,oe),n(oe,ue),n(P,ze),n(P,X),n(X,we),n(X,fe),n(S,Ie),n(S,x),n(x,re),n(u,Le),n(u,F),F.innerHTML=le,n(u,Me),h&&h.m(u,null),n(u,de),v&&v.m(u,null),n(u,pe),n(u,U),n(U,E),be(G,E,null),n(E,je),n(E,me),n(me,ce),n(E,Pe),be(J,E,null),n(U,Ce),n(U,A),be(K,A,null),n(A,Se),n(A,ve),n(ve,_e),M=!0,ke||(Ee=[H(r=e[5].call(null,i,e[0])),H(j=e[4].call(null,p,W(e[0].author))),H(I=e[5].call(null,s,e[0])),H($=e[4].call(null,P,W(e[0].author))),H(te=e[5].call(null,F,e[0])),H(ie=e[5].call(null,A,e[0])),H(se=e[5].call(null,U,e[0]))],ke=!0)},p(t,[f]){var Y,Te,Re,Ue,Ae;r&&N(r.update)&&f&1&&r.update.call(null,t[0]),t[2]==="linked-top"||t[2]==="linked-full"?q||(q=Ge(t),q.c(),q.m(p,o)):q&&(q.d(1),q=null),(!M||f&1&&a.src!==(m=(Re=(Te=(Y=t[0].author)==null?void 0:Y.profileImage)==null?void 0:Te.src)!=null?Re:"default.png"))&&c(a,"src",m),t[2]==="linked-bottom"||t[2]==="linked-full"?z||(z=Je(t),z.c(),z.m(p,null)):z&&(z.d(1),z=null),j&&N(j.update)&&f&1&&j.update.call(null,W(t[0].author)),I&&N(I.update)&&f&1&&I.update.call(null,t[0]),t[3]&&t[0].parent?g?g.p(t,f):(g=Ke(t),g.c(),g.m(u,D)):g&&(g.d(1),g=null),(!M||f&1)&&Z!==(Z=((Ue=t[0].author)==null?void 0:Ue.displayName)+"")&&T(ue,Z),(!M||f&1)&&y!==(y=((Ae=t[0].author)==null?void 0:Ae.username)+"")&&T(fe,y),$&&N($.update)&&f&1&&$.update.call(null,W(t[0].author)),(!M||f&1)&&ee!==(ee=Be(t[0].timestamp,"MMM d, yyy")+"")&&T(re,ee),(!M||f&1)&&le!==(le=Fe(t[0].content)+"")&&(F.innerHTML=le),te&&N(te.update)&&f&1&&te.update.call(null,t[0]),t[0].media.length?h?h.p(t,f):(h=Oe(t),h.c(),h.m(u,de)):h&&(h.d(1),h=null),t[7].default?v?(v.p(t,f),f&128&&B(v,1)):(v=Qe(t),v.c(),B(v,1),v.m(u,pe)):v&&(Ze(),V(v,1,1,()=>{v=null}),We()),(!M||f&1)&&ne!==(ne=t[0].likes.toLocaleString()+"")&&T(ce,ne),(!M||f&1)&&ae!==(ae=t[6](t[0]).toLocaleString()+"")&&T(_e,ae),ie&&N(ie.update)&&f&1&&ie.update.call(null,t[0]),se&&N(se.update)&&f&1&&se.update.call(null,t[0]),f&2&&R(l,"interactive",t[1]==="full"),f&9&&R(l,"is-reply",t[3]&&!!t[0].parent),f&4&&R(l,"linked-top",t[2]==="linked-top"||t[2]==="linked-full"),f&4&&R(l,"linked-bottom",t[2]==="linked-bottom"||t[2]==="linked-full")},i(t){M||(B(v),B(G.$$.fragment,t),B(J.$$.fragment,t),B(K.$$.fragment,t),M=!0)},o(t){V(v),V(G.$$.fragment,t),V(J.$$.fragment,t),V(K.$$.fragment,t),M=!1},d(t){t&&O(l),q&&q.d(),z&&z.d(),g&&g.d(),h&&h.d(),v&&v.d(),he(G),he(J),he(K),ke=!1,$e(Ee)}}}function tl(e,l,i){let{$$slots:r={},$$scope:_}=l;const p=Xe(r);let{post:o}=l,{interactive:a=void 0}=l,{type:m=void 0}=l,{showParent:b=!0}=l;const j=(s,I,...C)=>{a&&(s.classList.add("interactive"),s.addEventListener("click",()=>De(`#/user/${I.username}`)))},L=(s,I,...C)=>{a==="full"&&(s.classList.add("interactive"),s.addEventListener("click",()=>De(`#/post/${I.id}`)))},u=s=>{var I,C;let D=0;return D+=s.comments?s.comments.length+((C=(I=s.comments)===null||I===void 0?void 0:I.map(u).reduce((S,P)=>S+P,0))!==null&&C!==void 0?C:0):0,D};return e.$$set=s=>{"post"in s&&i(0,o=s.post),"interactive"in s&&i(1,a=s.interactive),"type"in s&&i(2,m=s.type),"showParent"in s&&i(3,b=s.showParent),"$$scope"in s&&i(8,_=s.$$scope)},[o,a,m,b,j,L,u,p,_,r]}class nl extends Ve{constructor(l){super();ye(this,l,tl,ll,xe,{post:0,interactive:1,type:2,showParent:3})}}export default nl;
