import"./Post.svelte.css.proxy.js";import{SvelteComponent as ce,add_render_callback as ue,append as g,attr as j,check_outros as N,create_component as S,create_in_transition as me,destroy_component as I,destroy_each as U,detach as $,element as y,empty as D,group_outros as z,init as ae,insert as w,listen as V,mount_component as L,noop as pe,safe_not_equal as W,set_data as X,space as O,text as E,transition_in as p,transition_out as d}from"../../_snowpack/pkg/svelte/internal.js";import{pop as Y}from"../../_snowpack/pkg/svelte-spa-router.js";import{fade as _e}from"../../_snowpack/pkg/svelte/transition.js";import Z from"../components/IconButton.svelte.js";import x from"../components/LargePostCard.svelte.js";import F from"../components/PostCard.svelte.js";import{assert as G}from"../util.js";function ee(c,t,f){const n=c.slice();return n[7]=t[f],n}function te(c,t,f){const n=c.slice();return n[10]=t[f],n}function de(c){let t,f,n,i,l,e,m,o,s=c[0].id+"",r,a,h,C;return i=new Z({props:{icon:"arrow-left",size:32,iconSize:20}}),{c(){t=y("header"),f=y("div"),n=y("div"),S(i.$$.fragment),l=O(),e=y("span"),m=E("Post not found: "),o=y("code"),r=E(s),j(f,"id","back-button-wrapper"),j(f,"class","svelte-3y7qmr"),j(e,"class","heading svelte-3y7qmr"),j(t,"class","svelte-3y7qmr")},m(b,q){w(b,t,q),g(t,f),g(f,n),L(i,n,null),g(t,l),g(t,e),g(e,m),g(e,o),g(o,r),a=!0,h||(C=V(n,"click",Y),h=!0)},p(b,q){(!a||q&1)&&s!==(s=b[0].id+"")&&X(r,s)},i(b){a||(p(i.$$.fragment,b),a=!0)},o(b){d(i.$$.fragment,b),a=!1},d(b){b&&$(t),I(i),h=!1,C()}}}function ke(c){var K,M;let t,f,n,i,l,e,m,o,s,r=((K=c[1].author)==null?void 0:K.username)+"",a,h,C,b,q,A,H,J;i=new Z({props:{icon:"arrow-left",size:32,iconSize:20}});let B=G(c[2]),_=[];for(let u=0;u<B.length;u+=1)_[u]=ne(te(c,B,u));const fe=u=>d(_[u],1,1,()=>{_[u]=null});let v=((M=c[1].comments)==null?void 0:M.length)&&le(c);return{c(){t=y("header"),f=y("div"),n=y("div"),S(i.$$.fragment),l=O(),e=y("span"),m=E("Post by "),o=y("b"),s=E("@"),a=E(r),h=O(),C=y("section");for(let u=0;u<_.length;u+=1)_[u].c();b=O(),v&&v.c(),q=D(),j(f,"id","back-button-wrapper"),j(f,"class","svelte-3y7qmr"),j(t,"class","svelte-3y7qmr"),j(C,"id","posts")},m(u,k){w(u,t,k),g(t,f),g(f,n),L(i,n,null),g(t,l),g(t,e),g(e,m),g(e,o),g(o,s),g(o,a),w(u,h,k),w(u,C,k);for(let T=0;T<_.length;T+=1)_[T].m(C,null);w(u,b,k),v&&v.m(u,k),w(u,q,k),A=!0,H||(J=V(n,"click",Y),H=!0)},p(u,k){var T,Q;if((!A||k&2)&&r!==(r=((T=u[1].author)==null?void 0:T.username)+"")&&X(a,r),k&28){B=G(u[2]);let P;for(P=0;P<B.length;P+=1){const R=te(u,B,P);_[P]?(_[P].p(R,k),p(_[P],1)):(_[P]=ne(R),_[P].c(),p(_[P],1),_[P].m(C,null))}for(z(),P=B.length;P<_.length;P+=1)fe(P);N()}((Q=u[1].comments)==null?void 0:Q.length)?v?(v.p(u,k),k&2&&p(v,1)):(v=le(u),v.c(),p(v,1),v.m(q.parentNode,q)):v&&(z(),d(v,1,1,()=>{v=null}),N())},i(u){if(!A){p(i.$$.fragment,u);for(let k=0;k<B.length;k+=1)p(_[k]);p(v),A=!0}},o(u){d(i.$$.fragment,u),_=_.filter(Boolean);for(let k=0;k<_.length;k+=1)d(_[k]);d(v),A=!1},d(u){u&&$(t),I(i),u&&$(h),u&&$(C),U(_,u),u&&$(b),v&&v.d(u),u&&$(q),H=!1,J()}}}function ne(c){let t,f,n;var i=c[4](c[10])?x:F;function l(e){return{props:{post:e[10],showParent:e[4](e[10]),interactive:e[4](e[10])?"header":"full",type:e[3](e[10])}}}return i&&(t=new i(l(c))),{c(){t&&S(t.$$.fragment),f=D()},m(e,m){t&&L(t,e,m),w(e,f,m),n=!0},p(e,m){const o={};if(m&4&&(o.post=e[10]),m&4&&(o.showParent=e[4](e[10])),m&4&&(o.interactive=e[4](e[10])?"header":"full"),m&4&&(o.type=e[3](e[10])),i!==(i=e[4](e[10])?x:F)){if(t){z();const s=t;d(s.$$.fragment,1,0,()=>{I(s,1)}),N()}i?(t=new i(l(e)),S(t.$$.fragment),p(t.$$.fragment,1),L(t,f.parentNode,f)):t=null}else i&&t.$set(o)},i(e){n||(t&&p(t.$$.fragment,e),n=!0)},o(e){t&&d(t.$$.fragment,e),n=!1},d(e){e&&$(f),t&&I(t,e)}}}function le(c){let t,f,n,i,l=c[1].comments,e=[];for(let o=0;o<l.length;o+=1)e[o]=ie(ee(c,l,o));const m=o=>d(e[o],1,1,()=>{e[o]=null});return{c(){t=y("h3"),t.textContent="Comments",f=O(),n=y("section");for(let o=0;o<e.length;o+=1)e[o].c();j(n,"id","comments")},m(o,s){w(o,t,s),w(o,f,s),w(o,n,s);for(let r=0;r<e.length;r+=1)e[r].m(n,null);i=!0},p(o,s){if(s&2){l=o[1].comments;let r;for(r=0;r<l.length;r+=1){const a=ee(o,l,r);e[r]?(e[r].p(a,s),p(e[r],1)):(e[r]=ie(a),e[r].c(),p(e[r],1),e[r].m(n,null))}for(z(),r=l.length;r<e.length;r+=1)m(r);N()}},i(o){if(!i){for(let s=0;s<l.length;s+=1)p(e[s]);i=!0}},o(o){e=e.filter(Boolean);for(let s=0;s<e.length;s+=1)d(e[s]);i=!1},d(o){o&&$(t),o&&$(f),o&&$(n),U(e,o)}}}function oe(c){var e,m,o;let t,f,n,i;t=new F({props:{post:c[7].comments[0],showParent:!1,interactive:"full",type:((m=(e=c[7].comments[0])==null?void 0:e.comments)==null?void 0:m.length)?"linked-full":"linked-top"}});let l=((o=c[7].comments[0].comments)==null?void 0:o.length)&&re(c);return{c(){S(t.$$.fragment),f=O(),l&&l.c(),n=D()},m(s,r){L(t,s,r),w(s,f,r),l&&l.m(s,r),w(s,n,r),i=!0},p(s,r){var h,C,b;const a={};r&2&&(a.post=s[7].comments[0]),r&2&&(a.type=((C=(h=s[7].comments[0])==null?void 0:h.comments)==null?void 0:C.length)?"linked-full":"linked-top"),t.$set(a),((b=s[7].comments[0].comments)==null?void 0:b.length)?l?(l.p(s,r),r&2&&p(l,1)):(l=re(s),l.c(),p(l,1),l.m(n.parentNode,n)):l&&(z(),d(l,1,1,()=>{l=null}),N())},i(s){i||(p(t.$$.fragment,s),p(l),i=!0)},o(s){d(t.$$.fragment,s),d(l),i=!1},d(s){I(t,s),s&&$(f),l&&l.d(s),s&&$(n)}}}function re(c){let t,f;return t=new F({props:{post:c[7].comments[0].comments[0],showParent:!1,interactive:"full",type:"linked-top"}}),{c(){S(t.$$.fragment)},m(n,i){L(t,n,i),f=!0},p(n,i){const l={};i&2&&(l.post=n[7].comments[0].comments[0]),t.$set(l)},i(n){f||(p(t.$$.fragment,n),f=!0)},o(n){d(t.$$.fragment,n),f=!1},d(n){I(t,n)}}}function ie(c){var e,m;let t,f,n,i;t=new F({props:{post:c[7],showParent:!0,interactive:"full",type:((e=c[7].comments)==null?void 0:e.length)?"linked-bottom":void 0}});let l=((m=c[7].comments)==null?void 0:m.length)&&oe(c);return{c(){S(t.$$.fragment),f=O(),l&&l.c(),n=D()},m(o,s){L(t,o,s),w(o,f,s),l&&l.m(o,s),w(o,n,s),i=!0},p(o,s){var a,h;const r={};s&2&&(r.post=o[7]),s&2&&(r.type=((a=o[7].comments)==null?void 0:a.length)?"linked-bottom":void 0),t.$set(r),((h=o[7].comments)==null?void 0:h.length)?l?(l.p(o,s),s&2&&p(l,1)):(l=oe(o),l.c(),p(l,1),l.m(n.parentNode,n)):l&&(z(),d(l,1,1,()=>{l=null}),N())},i(o){i||(p(t.$$.fragment,o),p(l),i=!0)},o(o){d(t.$$.fragment,o),d(l),i=!1},d(o){I(t,o),o&&$(f),l&&l.d(o),o&&$(n)}}}function se(c){let t,f,n,i,l,e;const m=[ke,de],o=[];function s(r,a){return r[1]?0:1}return n=s(c,-1),i=o[n]=m[n](c),{c(){t=y("div"),f=y("div"),i.c(),j(f,"id","post"),j(f,"class","svelte-3y7qmr")},m(r,a){w(r,t,a),g(t,f),o[n].m(f,null),e=!0},p(r,a){let h=n;n=s(r,a),n===h?o[n].p(r,a):(z(),d(o[h],1,1,()=>{o[h]=null}),N(),i=o[n],i?i.p(r,a):(i=o[n]=m[n](r),i.c()),p(i,1),i.m(f,null))},i(r){e||(p(i),l||ue(()=>{l=me(t,_e,{duration:100}),l.start()}),e=!0)},o(r){d(i),e=!1},d(r){r&&$(t),o[n].d()}}}function ve(c){let t=c[1],f,n,i=se(c);return{c(){i.c(),f=D()},m(l,e){i.m(l,e),w(l,f,e),n=!0},p(l,[e]){e&2&&W(t,t=l[1])?(z(),d(i,1,1,pe),N(),i=se(l),i.c(),p(i),i.m(f.parentNode,f)):i.p(l,e)},i(l){n||(p(i),n=!0)},o(l){d(i),n=!1},d(l){l&&$(f),i.d(l)}}}function he(c,t,f){let n,{hydrator:i}=t,{params:l={id:void 0}}=t,e=i.getPost(l.id);const m=(...r)=>r[0].parent?m(r[0].parent,...r):r,o=r=>{if((n==null?void 0:n.length)!==1)return(n==null?void 0:n.indexOf(r))===0?"linked-bottom":(n==null?void 0:n.indexOf(r))!==G(n==null?void 0:n.length)-1?"linked-full":"linked-top"},s=r=>r.id===G(e).id;return c.$$set=r=>{"hydrator"in r&&f(5,i=r.hydrator),"params"in r&&f(0,l=r.params)},c.$$.update=()=>{if(c.$$.dirty&33){e:f(1,e=i.getPost(l.id))}if(c.$$.dirty&2){e:f(2,n=e?m(e):void 0)}},[l,e,n,o,s,i]}class be extends ce{constructor(t){super();ae(this,t,he,ve,W,{hydrator:5,params:0})}}export default be;
