{"version":3,"names":[],"sources":["Post.svelte"],"sourcesContent":["<script lang=\"ts\">;\nimport { pop } from 'svelte-spa-router';\nimport { fade } from 'svelte/transition';\nimport IconButton from '../components/IconButton.svelte';\nimport LargePostCard from '../components/LargePostCard.svelte';\n;\nimport PostCard from '../components/PostCard.svelte';\nimport { assert } from '../util';\nexport let hydrator;\nexport let params = { id: undefined };\nlet currentPost = hydrator.getPost(params.id);\n$: currentPost = hydrator.getPost(params.id);\nconst getParents = (...chain) => {\n    return chain[0].parent ? getParents(chain[0].parent, ...chain) : chain;\n};\n$: postChain = currentPost ? getParents(currentPost) : undefined;\nconst getPostCardType = (post) => {\n    if ((postChain === null || postChain === void 0 ? void 0 : postChain.length) === 1)\n        return undefined;\n    return (postChain === null || postChain === void 0 ? void 0 : postChain.indexOf(post)) === 0\n        ? 'linked-bottom'\n        : (postChain === null || postChain === void 0 ? void 0 : postChain.indexOf(post)) !== assert(postChain === null || postChain === void 0 ? void 0 : postChain.length) - 1\n            ? 'linked-full'\n            : 'linked-top';\n};\nconst isCurrent = (post) => post.id === assert(currentPost).id;\n//# sourceMappingURL=Post.svelte.js.map</script>\n\n<style lang=\"scss\">#post {\n  max-width: 700px;\n  margin: 0 auto;\n}\n\nheader {\n  display: flex;\n  align-items: center;\n  margin-bottom: 0.25rem;\n}\nheader .heading {\n  margin: 0;\n}\nheader #back-button-wrapper {\n  margin-right: 0.25rem;\n}</style>\n\n{#key currentPost}\n  <div in:fade={{ duration: 100 }}>\n    <div id=\"post\">\n      {#if currentPost}\n        <header>\n          <div id=\"back-button-wrapper\">\n            <div on:click={pop}>\n              <IconButton icon=\"arrow-left\" size={32} iconSize={20} />\n            </div>\n          </div>\n          <span>Post by <b>@{currentPost.author?.username}</b></span>\n        </header>\n        <section id=\"posts\">\n          {#each assert(postChain) as post}\n            <svelte:component\n              this={isCurrent(post) ? LargePostCard : PostCard}\n              {post}\n              showParent={isCurrent(post)}\n              interactive={isCurrent(post) ? 'header' : 'full'}\n              type={getPostCardType(post)}\n            />\n          {/each}\n        </section>\n        {#if currentPost.comments?.length}\n          <h3>Comments</h3>\n          <section id=\"comments\">\n            {#each [...currentPost.comments].sort(({ timestamp: a }, { timestamp: b }) => b.getTime() - a.getTime()) as comment}\n              <PostCard\n                post={comment}\n                showParent\n                interactive=\"full\"\n                type={comment.comments?.length ? 'linked-bottom' : undefined}\n              />\n              {#if comment.comments?.length}\n                <PostCard\n                  post={comment.comments[0]}\n                  showParent={false}\n                  interactive=\"full\"\n                  type={comment.comments[0]?.comments?.length ? 'linked-full' : 'linked-top'}\n                />\n                {#if comment.comments[0].comments?.length}\n                  <PostCard\n                    post={comment.comments[0].comments[0]}\n                    showParent={false}\n                    interactive=\"full\"\n                    type=\"linked-top\"\n                  />\n                {/if}\n              {/if}\n            {/each}\n          </section>\n        {/if}\n      {:else}\n        <header>\n          <div id=\"back-button-wrapper\">\n            <div on:click={pop}>\n              <IconButton icon=\"arrow-left\" size={32} iconSize={20} />\n            </div>\n          </div>\n          <span class=\"heading\">Post not found: <code>{params.id}</code></span>\n        </header>\n      {/if}\n    </div>\n  </div>\n{/key}\n"],"mappings":"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"}